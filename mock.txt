package com.edutech.educationapplication.entity;

import javax.persistence.*;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;

@Entity
public class Course {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long courseId;

    private String courseName;
    private String courseDescription;
    private int studentsEnrolled;
    private int lessonsCount;

    @ManyToOne
    @JoinColumn(name = "tutor_id")
    @JsonIgnoreProperties
    private Tutor tutor;

    public Course() {}

    public Long getCourseId() {
        return courseId;
    }

    public void setCourseId(Long courseId) {
        this.courseId = courseId;
    }

    public String getCourseName() {
        return courseName;
    }

    public void setCourseName(String courseName) {
        this.courseName = courseName;
    }

    public String getCourseDescription() {
        return courseDescription;
    }

    public void setCourseDescription(String courseDescription) {
        this.courseDescription = courseDescription;
    }

    public int getStudentsEnrolled() {
        return studentsEnrolled;
    }

    public void setStudentsEnrolled(int studentsEnrolled) {
        this.studentsEnrolled = studentsEnrolled;
    }

    public int getLessonsCount() {
        return lessonsCount;
    }

    public void setLessonsCount(int lessonsCount) {
        this.lessonsCount = lessonsCount;
    }

    public Tutor getTutor() {
        return tutor;
    }

    public void setTutor(Tutor tutor) {
        this.tutor = tutor;
    }
}





package com.edutech.educationapplication.entity;


import com.fasterxml.jackson.annotation.JsonIgnore;
import com.fasterxml.jackson.annotation.JsonIgnoreProperties;

import javax.persistence.*;
import java.util.ArrayList;
import java.util.List;


@Entity
public class Tutor {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long tutorId;

    private String tutorName;
    private String expertise;

    @OneToMany(mappedBy = "tutor", cascade = CascadeType.ALL, orphanRemoval = true)
    @JsonIgnoreProperties
    private List<Course> courses;

    public Tutor() {}

    public Long getTutorId() {
        return tutorId;
    }

    public void setTutorId(Long tutorId) {
        this.tutorId = tutorId;
    }

    public String getTutorName() {
        return tutorName;
    }

    public void setTutorName(String tutorName) {
        this.tutorName = tutorName;
    }

    public String getExpertise() {
        return expertise;
    }

    public void setExpertise(String expertise) {
        this.expertise = expertise;
    }

    public List<Course> getCourses() {
        return courses;
    }

    public void setCourses(List<Course> courses) {
        this.courses = courses;
    }
}


package com.edutech.educationapplication.repository;


import java.util.List;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;
import org.springframework.stereotype.Repository;

import com.edutech.educationapplication.entity.Course;

@Repository
public interface CourseRepository extends JpaRepository<Course, Long> {

    @Query("SELECT c FROM Course c WHERE c.courseName = :courseName")
    List<Course> findAllByCourseName(@Param("courseName") String courseName);
}

package com.edutech.educationapplication.repository;


import java.util.List;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;
import org.springframework.stereotype.Repository;

import com.edutech.educationapplication.entity.Tutor;

@Repository
public interface TutorRepository extends JpaRepository<Tutor, Long> {

    @Query("SELECT t FROM Tutor t WHERE t.tutorName = :tutorName")
    List<Tutor> findAllByTutorName(@Param("tutorName") String tutorName);
}


package com.edutech.educationapplication.service;


import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.edutech.educationapplication.entity.Course;
import com.edutech.educationapplication.repository.CourseRepository;

import java.util.List;
import java.util.Optional;


@Service
public class CourseService {

    @Autowired
    private CourseRepository courseRepository;

    public Course addCourse(Course course) {
        return courseRepository.save(course);
    }

    public List<Course> getAllCourses(String courseName) {
        return courseRepository.findAllByCourseName(courseName);
    }

    public Course updateCourse(Long courseId, Course course) {
        Optional<Course> existing = courseRepository.findById(courseId);
        if (existing.isPresent()) {
            Course c = existing.get();
            c.setCourseName(course.getCourseName());
            c.setCourseDescription(course.getCourseDescription());
            c.setStudentsEnrolled(course.getStudentsEnrolled());
            c.setLessonsCount(course.getLessonsCount());
            c.setTutor(course.getTutor());
            return courseRepository.save(c);
        }
        return null;
    }

    public void deleteCourse(Long courseId) {
        courseRepository.deleteById(courseId);
    }
}




package com.edutech.educationapplication.service;


import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.edutech.educationapplication.entity.Tutor;
import com.edutech.educationapplication.repository.TutorRepository;



import java.util.List;
import java.util.Optional;


@Service
public class TutorService {

    @Autowired
    private TutorRepository tutorRepository;

    public Tutor addTutor(Tutor tutor) {
        return tutorRepository.save(tutor);
    }

    public List<Tutor> getAllTutors(String tutorName) {
        return tutorRepository.findAllByTutorName(tutorName);
    }

    public Tutor updateTutor(Long tutorId, Tutor tutor) {
        Optional<Tutor> existing = tutorRepository.findById(tutorId);
        if (existing.isPresent()) {
            Tutor t = existing.get();
            t.setTutorName(tutor.getTutorName());
            t.setExpertise(tutor.getExpertise());
            //t.setCourses(tutor.getCourses());
            return tutorRepository.save(t);
        }
        return null;
    }

    public void deleteTutor(Long tutorId) {
        tutorRepository.deleteById(tutorId);
    }
}



package com.edutech.educationapplication.controller;


import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import com.edutech.educationapplication.entity.Course;
import com.edutech.educationapplication.service.CourseService;

import java.util.List;


@RestController
@RequestMapping("/courses")
public class CourseController {

    @Autowired
    private CourseService courseService;

    @PostMapping
    public Course addCourse(@RequestBody Course course) {
        return courseService.addCourse(course);
    }

    @GetMapping("/{courseName}")
    public ResponseEntity<?> getAllCourses(@PathVariable String courseName){
  
        return new ResponseEntity<>(courseService.getAllCourses(courseName),HttpStatus.OK);
    }

    @PutMapping("/{courseId}")
    public Course updateCourse(@PathVariable Long id, @RequestBody Course course) {
        return courseService.updateCourse(id, course);
    }


}


package com.edutech.educationapplication.controller;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import com.edutech.educationapplication.entity.Tutor;
import com.edutech.educationapplication.service.TutorService;

import java.util.List;


@RestController
@RequestMapping("/api/tutors")
public class TutorController {

    @Autowired
    private TutorService tutorService;

    @PostMapping
    public Tutor addTutor(@RequestBody Tutor tutor) {
        return tutorService.addTutor(tutor);
    }

    @GetMapping("/{tutorName}")
    public ResponseEntity<?> getAllTutors(@PathVariable String tutorName){
        return new ResponseEntity<>(tutorService.getAllTutors(tutorName),HttpStatus.OK);

    }

    @PutMapping("/{id}")
    public Tutor updateTutor(@PathVariable Long id, @RequestBody Tutor tutor) {
        return tutorService.updateTutor(id, tutor);
    }

    @DeleteMapping("/{id}")
    public void deleteTutor(@PathVariable Long id) {
        tutorService.deleteTutor(id);
    }
}

